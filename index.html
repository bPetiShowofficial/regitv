<!DOCTYPE html>
<html lang="hu">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <title>Magyar Retro TV</title>
    <link rel="preconnect" href="https://www.youtube.com">
    <link rel="preconnect" href="https://www.google.com">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <style>
        :root {
            --tv-body: #1a1a1a;
            --tv-bezel: #2a2a2a;
            --screen-glow: rgba(200, 200, 255, 0.05);
        }

        * {
            box-sizing: border-box;
        }

        body {
            background-color: #070707;
            background-image:
                radial-gradient(circle at center, rgba(30, 30, 40, 0.4) 0%, transparent 70%),
                url("data:image/svg+xml,%3Csvg width='150' height='150' viewBox='0 0 150 150' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.05'/%3E%3C/svg%3E");
            height: 100vh;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Courier New', monospace;
            overflow: hidden;
            color: #ddd;
        }

        .tv-set {
            position: relative;
            width: auto;
            height: 90vh;
            aspect-ratio: 4/3;
            max-width: 95vw;
            max-height: 90vh;
            background: var(--tv-bezel);
            border-radius: 2px;
            padding: 0;
            box-shadow:
                inset 0 0 40px rgba(0, 0, 0, 0.8),
                0 0 100px rgba(0, 0, 0, 0.9),
                0 20px 50px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            border: 4px solid #111;
            transform-origin: center;
            filter: drop-shadow(0 0 40px rgba(100, 150, 255, 0.1));
            will-change: transform;
            /* Teljesítmény optimalizálás */
        }

        .tv-set::after {
            content: '';
            position: absolute;
            top: -20%;
            left: -10%;
            right: -10%;
            bottom: -20%;
            background: radial-gradient(circle at center, rgba(100, 150, 255, 0.08) 0%, transparent 70%);
            z-index: -1;
            pointer-events: none;
            animation: ambient-pulse 6s infinite alternate;
        }

        /* Sleep Mode: Ha a TV ki van kapcsolva, minden animáció leáll a teljesítmény érdekében */
        /* Sleep Mode: Ha a TV ki van kapcsolva, minden animáció leáll a teljesítmény érdekében */
        .tv-set.power-off .scanlines,
        .tv-set.power-off .flicker,
        .tv-set.power-off .phosphor-mask,
        .tv-set.power-off::after {
            display: none !important;
            animation: none !important;
        }

        /* Javítás: Az overlay maradjon kattintható, de ne legyen rajta effekt */
        .tv-set.power-off .glass-overlay {
            background: transparent !important;
            box-shadow: none !important;
            /* Click events maradnak! */
        }

        .tv-set.power-off .crt-screen {
            mask-image: none !important;
            -webkit-mask-image: none !important;
            background: #050505;
        }

        @keyframes ambient-pulse {
            0% {
                opacity: 0.4;
                transform: scale(0.95);
            }

            100% {
                opacity: 1;
                transform: scale(1.05);
            }
        }

        @media (max-width: 850px) {
            .tv-set {
                width: 100vw;
                height: auto;
                aspect-ratio: 4/3.8;
                max-width: 100vw;
                max-height: 80vh;
                border: 1px solid #333;
                border-radius: 4px;
                background: #111 !important;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
                filter: none;
            }

            .screen-container {
                border: none !important;
            }

            .controls-panel {
                padding: 15px !important;
                height: auto !important;
                flex-direction: column !important;
                justify-content: center !important;
                align-items: center !important;
                gap: 12px !important;
                background: #111 !important;
                border-top: none !important;
            }

            .buttons {
                gap: 10px;
                flex-wrap: wrap;
                justify-content: center !important;
                width: 100%;
            }

            .btn {
                width: 48px;
                height: 48px;
                font-size: 9px;
            }

            .channel-display {
                font-size: 18px;
                padding: 6px 14px;
                margin-bottom: 2px;
            }

            .brand-logo {
                display: none;
            }

            /* Teljesítmény optimalizálás: Nehéz SVG zaj effekt kikapcsolása mobilon */
            #static-noise::after {
                background-image: none !important;
                background: repeating-linear-gradient(45deg, #111 0px, #222 1px, #111 2px) !important;
                opacity: 0.1 !important;
                animation: none !important;
            }
        }

        /* Android TV / Low Spec Optimization */
        body.tv-mode .phosphor-mask,
        body.tv-mode .flicker,
        body.tv-mode .glass-overlay,
        body.tv-mode .tv-set::after {
            display: none !important;
            animation: none !important;
        }

        body.tv-mode .scanlines {
            opacity: 0.3 !important;
            background-image: linear-gradient(rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0.2) 50%) !important;
        }

        body.tv-mode .tv-set {
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.8) !important;
            filter: none !important;
            background: #111 !important;
            /* Unified Dark Theme */
            border: 2px solid #333 !important;
            /* Vékony külső keret */
        }

        body.tv-mode .tv-set::before {
            display: none !important;
            /* Fix top bezel color mismatch */
        }

        body.tv-mode .channel-display {
            font-size: 16px !important;
            padding: 3px 10px !important;
            min-width: 25px !important;
        }

        body.tv-mode .brand-logo {
            font-size: 18px !important;
            letter-spacing: 2px !important;
        }

        body.tv-mode .controls-panel {
            backdrop-filter: none !important;
            background: #111 !important;
            /* Egybeolvad a kerettel */
            border-top: none !important;
            box-shadow: none !important;
            padding: 0 20px !important;
            /* Reduce horizontal crowding */
            height: 60px !important;
            /* Slimmer panel */
        }

        body.tv-mode .btn {
            width: 40px !important;
            height: 40px !important;
            font-size: 8px !important;
        }

        body.tv-mode .crt-screen {
            mask-image: none !important;
            -webkit-mask-image: none !important;
            border-radius: 0 !important;
            border: none !important;
            /* Keret eltávolítva */
        }

        body.tv-mode .screen-container {
            border: none !important;
            /* Belső vastag keret eltávolítva */
            box-shadow: none !important;
            /* Flatten look */
        }

        /* Landscape optimalizáció mobilon */
        @media (max-width: 950px) and (orientation: landscape) {
            .tv-set {
                height: 100vh;
                height: 100dvh;
                width: auto;
                aspect-ratio: 4/3;
                max-width: 100vw;
                margin: 0 auto;
                border: 1px solid #333 !important;
                background: #111 !important;
            }

            .screen-container {
                border: none !important;
            }

            .controls-panel {
                padding: 0 10px !important;
                height: 50px !important;
                flex-direction: row !important;
                justify-content: center !important;
                align-items: center !important;
                flex-shrink: 0;
            }

            .buttons {
                justify-content: center !important;
                align-items: center !important;
                gap: 8px !important;
                width: auto !important;
                flex-wrap: nowrap !important;
            }

            .btn {
                width: 32px !important;
                height: 32px !important;
                font-size: 7px !important;
            }

            #scan-btn .full-label {
                display: none;
            }

            #scan-btn .short-label {
                display: inline;
                font-size: 10px !important;
                line-height: 1;
            }

            .brand-logo {
                display: none !important;
            }

            .channel-display {
                font-size: 14px;
                padding: 3px 10px;
                min-width: 30px;
                margin: 0 !important;
                /* Fix misalignment */
                line-height: 1;
                display: flex;
                align-items: center;
                height: 32px;
                /* Match button height */
            }
        }

        .tv-set::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 2px;
            border: 2px solid #444;
            pointer-events: none;
            opacity: 0.3;
        }

        .screen-container {
            position: relative;
            flex-grow: 1;
            background: #000;
            overflow: hidden;
            box-shadow: inset 0 0 80px rgba(0, 0, 0, 1);
            border: 20px solid var(--tv-bezel);
            border-bottom: none;
            z-index: 10;
        }

        #youtube-player {
            width: 100%;
            height: 100%;
            border: none;
            opacity: 0;
            transition: opacity 0.5s, transform 0.3s ease;
            transform: scale(1.05);
            /* Visszaállítva az eredetire */
            filter: contrast(1.1) brightness(1.1) saturate(1.2);
            pointer-events: none;
            position: relative;
            will-change: transform, opacity, filter;
        }

        /* Reálisabb V-Sync ugrás effekt */
        .vsync-jump {
            animation: vsync-anim 0.15s ease-out;
        }

        @keyframes vsync-anim {
            0% {
                transform: scale(1.15) translateY(0);
                filter: brightness(0);
            }

            0% {
                transform: scale(1.05) translateY(0);
                filter: brightness(0);
            }

            20% {
                transform: scale(1.05) translateY(-5%);
                filter: brightness(2);
            }

            40% {
                transform: scale(1.05) translateY(5%);
                filter: brightness(0);
            }

            100% {
                transform: scale(1.05) translateY(0);
                filter: brightness(1);
            }
        }

        .tv-set.zoom-active #youtube-player {
            transform: scale(1.4) !important;
            /* Visszaállítva */
        }

        .tv-set.zoom-active .crt-screen.crt-off #youtube-player {
            transform: scale(1.35) !important;
            /* Visszaállítva */
        }

        .crt-screen {
            width: 100%;
            height: 100%;
            position: relative;
            background: #111;
            overflow: hidden;
            mask-image: radial-gradient(circle at center, white 70%, black 100%);
            -webkit-mask-image: radial-gradient(circle at center, white 70%, black 100%);
        }

        .scanlines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.1);
            background-image: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
            background-size: 100% 3px;
            pointer-events: none;
            z-index: 20;
            opacity: 0.8;
        }

        .phosphor-mask {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.03));
            background-size: 3px 100%;
            pointer-events: none;
            z-index: 21;
        }

        .glass-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.05) 0%, transparent 60%),
                radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.05) 0%, transparent 40%),
                radial-gradient(circle at center, transparent 70%, rgba(0, 0, 0, 0.3) 100%);
            box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.4);
            pointer-events: auto;
            z-index: 25;
            border-radius: 2px;
        }

        .flicker {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.015);
            pointer-events: none;
            z-index: 22;
            animation: flicker-anim 0.1s infinite;
        }

        @keyframes flicker-anim {
            0% {
                opacity: 0.1;
            }

            50% {
                opacity: 0.2;
            }

            100% {
                opacity: 0.1;
            }
        }

        #static-noise {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #111;
            opacity: 0;
            pointer-events: none;
            overflow: hidden;
            z-index: 15;
        }

        .crt-off .scanlines,
        .crt-off .phosphor-mask,
        .crt-off .flicker {
            display: none;
        }

        .crt-off .glass-overlay {
            background: transparent;
            box-shadow: none;
        }

        .crt-off.crt-screen {
            mask-image: none;
            -webkit-mask-image: none;
        }

        .crt-off #youtube-player {
            transform: scale(1.05);
            /* Visszaállítva */
            filter: none;
        }

        #static-noise::after {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
            animation: noise-anim 0.1s steps(2) infinite;
            opacity: 0.6;
        }

        #static-noise::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.4), transparent);
            z-index: 16;
            animation: sync-bar-anim 2s linear infinite;
            opacity: 0;
        }

        .tv-set.changing-channel #static-noise::before {
            opacity: 1;
        }

        @keyframes sync-bar-anim {
            0% {
                transform: translateY(-100%);
            }

            100% {
                transform: translateY(600px);
            }
        }

        @keyframes noise-anim {
            0% {
                transform: translate(0, 0);
            }

            10% {
                transform: translate(-10px, -10px);
            }

            20% {
                transform: translate(10px, 5px);
            }

            30% {
                transform: translate(-5px, 15px);
            }

            40% {
                transform: translate(15px, -5px);
            }

            50% {
                transform: translate(-15px, 10px);
            }

            60% {
                transform: translate(5px, -15px);
            }

            70% {
                transform: translate(-10px, 5px);
            }

            80% {
                transform: translate(15px, 15px);
            }

            90% {
                transform: translate(-5px, -10px);
            }

            100% {
                transform: translate(0, 0);
            }
        }

        .controls-panel {
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 40px;
            background: var(--tv-bezel);
            z-index: 30;
        }

        .brand-logo {
            font-weight: bold;
            font-size: 24px;
            color: #888;
            letter-spacing: 4px;
            text-transform: uppercase;
            text-shadow: 1px 1px 0 #000;
        }

        .buttons {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: radial-gradient(circle at 30% 30%, #444, #111);
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.8), inset 1px 1px 2px rgba(255, 255, 255, 0.1);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-weight: bold;
            font-size: 10px;
            text-transform: uppercase;
            line-height: 1.2;
            text-align: center;
        }

        .btn.on {
            background: radial-gradient(circle at 30% 30%, #222, #000);
            color: #0f0;
            box-shadow: inset 2px 2px 5px rgba(0, 0, 0, 1), 0 0 5px rgba(0, 255, 0, 0.2);
        }

        .btn-power {
            background: radial-gradient(circle at 30% 30%, #d00, #500);
            color: #fff;
        }

        .btn-power.on {
            box-shadow: 0 0 10px #f00, 2px 2px 5px #000;
            background: radial-gradient(circle at 30% 30%, #f00, #800);
        }

        /* Teljes képernyő gomb kiemelése */
        #fs-btn {
            color: #9ab;
            font-size: 27px !important;
        }

        #scan-btn {
            font-size: 8px !important;
            letter-spacing: -0.3px;
        }

        .short-label {
            display: none;
        }

        .channel-display {
            font-family: 'Digital-7', monospace;
            background: #000;
            color: #0f0;
            padding: 5px 15px;
            font-size: 20px;
            border-radius: 4px;
            border: 2px solid #333;
            min-width: 30px;
            text-align: center;
        }

        @keyframes turnOn {
            0% {
                transform: scale(1, 0.005) translateY(0);
                filter: brightness(20);
            }

            50% {
                transform: scale(1, 0.005);
                filter: brightness(10);
            }

            51% {
                transform: scale(1, 1);
                filter: brightness(5);
            }

            100% {
                transform: scale(1, 1);
                filter: brightness(1);
            }
        }

        /* Blackout effekt váltáskor */
        .blackout {
            animation: blackout-anim 0.3s ease-out;
        }

        @keyframes blackout-anim {
            0% {
                filter: brightness(0);
            }

            30% {
                filter: brightness(0);
            }

            100% {
                filter: brightness(1);
            }
        }

        .tv-fullscreen-mode {
            border: none !important;
            box-shadow: none !important;
            filter: none !important;
            transition: none !important;
        }

        .tv-fullscreen-mode .screen-container {
            border: none !important;
        }

        .tv-fullscreen-mode .controls-panel {
            position: absolute;
            bottom: -100px;
            /* Alapból elrejtve */
            left: 50%;
            transform: translateX(-50%);
            width: auto;
            min-width: 320px;
            height: auto !important;
            min-height: 70px;
            background: rgba(15, 15, 15, 0.95) !important;
            padding: 15px 25px !important;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            z-index: 1000;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            pointer-events: auto;
            display: flex;
            flex-direction: row !important;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .tv-fullscreen-mode.show-controls .controls-panel {
            bottom: 40px;
            /* Feljebb hozzuk, hogy kényelmes legyen */
            opacity: 1;
        }

        .tv-fullscreen-mode .brand-logo {
            display: none !important;
        }

        /* Hover zone kivezetése, helyette kattintás lesz */
        .tv-fullscreen-mode .hover-zone {
            display: none !important;
        }

        /* Manuális fallback mód mobilos Safarihoz */
        .tv-set.manual-fullscreen {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100dvh !important;
            z-index: 9999 !important;
            margin: 0 !important;
        }

        /* Fullscreen gomb méretek mobilon, különös tekintettel a landscape nézetre */
        @media (max-width: 950px) {
            .tv-fullscreen-mode .btn {
                width: 48px !important;
                height: 48px !important;
                font-size: 9px !important;
            }

            .tv-fullscreen-mode .controls-panel {
                min-height: 80px !important;
                gap: 20px !important;
            }

            .tv-fullscreen-mode .channel-display {
                font-size: 20px !important;
                padding: 5px 15px !important;
            }
        }

        /* OSD Styles - Global */
        #osd-container {
            position: absolute;
            top: 12%;
            left: 8%;
            z-index: 9999;
            pointer-events: none;
            color: #2f2;
            text-shadow: 2px 2px 4px #000, 0 0 10px rgba(0, 255, 0, 0.5);
            font-family: 'Courier New', monospace;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            line-height: 1.4;
            max-width: 80%;
        }

        #osd-container.show {
            opacity: 1;
        }

        #osd-channel {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        #osd-title {
            font-size: 1.2rem;
            text-transform: uppercase;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        #osd-remaining {
            font-size: 1rem;
            background: rgba(0, 40, 0, 0.4);
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
        }

        @media (max-width: 850px) {
            #osd-channel {
                font-size: 1.8rem;
            }

            #osd-title {
                font-size: 0.9rem;
            }

            #osd-remaining {
                font-size: 0.8rem;
            }
        }
    </style>
</head>

<body>
    <div class="tv-set">
        <div class="screen-container">
            <div class="crt-screen">
                <div class="scanlines"></div>
                <div class="phosphor-mask"></div>
                <div class="flicker"></div>
                <div class="glass-overlay"></div>
                <div id="static-noise"></div>
                <div id="youtube-player"></div>
                <div id="osd-container">
                    <div id="osd-channel"></div>
                    <div id="osd-title"></div>
                    <div id="osd-remaining"></div>
                </div>
            </div>
        </div>
        <div class="hover-zone"></div>
        <div class="controls-panel">
            <div class="brand-logo">RETRO TV</div>
            <div class="buttons">
                <div class="channel-display" id="channel-num">--</div>
                <button class="btn" onclick="prevChannel()" title="Előző Csatorna">▼</button>
                <button class="btn" onclick="nextChannel()" title="Következő Csatorna">▲</button>
                <button class="btn" id="scan-btn" onclick="toggleZoom()" title="Képernyő kitöltése (Scan)">
                    <span class="full-label"><br>KÉPARÁNY<br>4:3</span>
                    <span class="short-label">4:3</span>
                </button>
                <button class="btn on" id="crt-btn" onclick="toggleCRT()" title="CRT Effekt ki/be">CRT</button>
                <button class="btn" id="vol-btn" onclick="toggleMute()" title="Némítás ki/be">HANG</button>
                <button class="btn" id="fs-btn" onclick="toggleFullscreen()" title="Teljes képernyő">⛶</button>
                <button class="btn btn-power" id="power-btn" onclick="togglePower()" title="Bekapcsolás">BE/KI</button>
            </div>
        </div>
    </div>

    <script>
        const CHANNELS = [
            {
                number: "01",
                playlist: [
                    { title: "Andy, a vagány- Cikis vicc", id: "M1GJQQW3tCo", duration: 1275 },
                    { title: "Louie élete - Mrs. Stillman karácsonyi meglepetése", id: "X_hUQCIHTDM", duration: 1172 },
                    { title: "Rube, a csodabogár- Bolhagy bosszúja", id: "5SGNXc5Oxyo", duration: 682 },
                    { title: "A Kullancs- Szennytelenítés", id: "UcSXFi4K0c4", duration: 1200 },
                    { title: "Walter Melon, szuperhős rendelésre- Melaszik Park/Szupermanus", id: "dAdU0emDgnA", duration: 1386 },
                    { title: "Kölykök a 402-es tanteremből- Einstein fia", id: "TtJPh_RwcPE", duration: 1275 },
                    { title: "A kémkutyák titkos aktái 1. rész", id: "DeFgSw5xyy4", duration: 1215 },
                    { title: "Három jóbarát és Jerry - A rágcsáló kiállítás", id: "AiCl49qTigg", duration: 501 },
                    { title: "Jack, a Kalóz - A három boszorkány legendás kincse", id: "Nnh98VdFrjU", duration: 1218 },
                    { title: "Denis a Komisz 1 rész", id: "5fE9xC8tM3E", duration: 1284 },
                    { title: "Nyekk, a macska- Srácok a hátsó udvarból", id: "yUWYTASXuF8", duration: 1206 },
                    { title: "Andy, a vagány- Mulya mályva", id: "h66GsBrDQXo", duration: 1274 },
                    { title: "Kölykök a 402-es tanteremből- Közlekedési rendőrök", id: "X9TCl41qiLg", duration: 1275 },
                    { title: "Oggy és a svábbogarak- Strike!", id: "gwTW7CCgFH0", duration: 384 },
                    { title: "Jim Button- Mandala", id: "0uwZRHNHNn4", duration: 1385 },
                    { title: "Gógyi felügyelő: A tavi szörny átka", id: "UbqaKqjn8zQ", duration: 1340 },
                    { title: "Walter Melon, szuperhős rendelésre- Robin Wood", id: "WZlYGlXP2to", duration: 742 },
                    { title: "Nyekk, a macska- Cicamica, szeress belém!", id: "4Oc24HI5dzI", duration: 1217 },
                    { title: "Kölykök a 402-es tanteremből- A rágott rágógumik bolygója", id: "IaauxlnAF0Y", duration: 1277 },
                    { title: "Dennis, a komisz - Halászd a bajt/Vágyott vagyon/Időzített bomba", id: "nCEtG83qjYU", duration: 1327 },
                    { title: "Louie élete - Apát kirúgják", id: "ro3XDlmHmB8", duration: 1201 },
                    { title: "A kémkutyák titkos aktái 2. rész", id: "-IAwJ6NbRoM", duration: 1217 },
                    { title: "Jack, a Kalóz - A kék karbunkulus átka", id: "VlVmYSXKwEU", duration: 1206 },
                    { title: "A Kullancs- A Kullancs és a Télapó", id: "w_pMG8s26mc", duration: 1217 },
                    { title: "Heathcliff- A nagy Pussini/Cicus az állatmenhelyen", id: "x_CsfGdZt2M", duration: 1275 },
                    { title: "Kölykök a 402-es tanteremből- Egyszemélyes bizottság", id: "U5IJe6KycW0", duration: 1277 },
                    { title: "A kémkutyák titkos aktái 3. rész", id: "-8NX5ZSXecg", duration: 1218 },
                    { title: "Rossz kutya- Pötyi, a bálvány/Csuklás ellen nincs orvosság", id: "KhE46ESUekQ", duration: 1216 },
                    { title: "Három jóbarát és Jerry - A helyettes tanárnő/Zöld övezet", id: "wGqjvQF2mf8", duration: 1291 },
                    { title: "Gógyi felügyelő 3.rész Küldetés a tanyán", id: "-39El-Yhca8", duration: 1338 },
                    { title: "Rube, a csodabogár- A barlangászok ásza/Kacagó sziget", id: "nZBs2X-Nnrg", duration: 1284 },
                    { title: "Kölykök a 402-es tanteremből- Fél ész", id: "dImJo9ZR7qU", duration: 1276 },
                    { title: "Andy, a vagány- Győzd le a bombát!", id: "WUQCDNvNDik", duration: 1278 },
                    { title: "Walter Melon, szuperhős rendelésre- Trotyi XII/Pán Péter", id: "--DJthJ1iSE", duration: 1389 },
                    { title: "A kémkutyák titkos aktái 4. rész", id: "OXfb4f5vCJo", duration: 1219 },
                    { title: "Nyekk, a macska- Repülő edények", id: "59qMArIKbyY", duration: 1225 },
                    { title: "A kullancs - És a nem közönséges nátha", id: "v5cu8eK_UeU", duration: 1208 },
                    { title: "Rube, a csodabogár- Virtuális valóság-sokk/Új gazdagék", id: "g2sZET0eYq8", duration: 1282 },
                    { title: "Gógyi felügyelő 4.rész Cirkuszi küldetés", id: "-C8yKexxlPg", duration: 1339 },
                    { title: "Kölykök a 402-es tanteremből- Gyáva kukac", id: "0NT3Bk7Yw00", duration: 1277 },
                    { title: "Három jóbarát és Jerry - A Banda/Divat/Hógolyó csata", id: "gksNP95i38I", duration: 1346 },
                    { title: "A kullancs - Ananász anasztáz ellen", id: "RRk4wGD-PrM", duration: 1207 },
                    { title: "Nyekk, a macska- Szép remények", id: "fpxlwyp6f88", duration: 1162 }
                ]
            },
            {
                number: "02",
                playlist: [
                    { title: "Bigyó felügyelő 2", id: "UhDSgs19n_U", duration: 5105 },
                    { title: "Én a vízilovakkal vagyok", id: "blx3gDcWxGQ", duration: 5513 },
                    { title: "Egy amerikai Kínában", id: "uKCruWyxTzg", duration: 5182 },
                    { title: "A keresztapus", id: "juXIzQvJSsA", duration: 5967 },
                    { title: "Töketlenek", id: "jauV_f53JuA", duration: 5451 },
                    { title: "Linda - A szatír", id: "O8N2hG8p5-8", duration: 3240 },
                    { title: "Ne légy barom, míg iszod a dzsúszod a gettóban", id: "KTzlt6M-2oc", duration: 5332 },
                    { title: "Hamis a baba", id: "I8H5kG2p1-M", duration: 5160 }
                ]
            }
        ];

        const REFERENCE_TIME = 1738368000; // 2026. Febr. 1. 00:00:00
        const STORAGE_KEY_BROKEN = 'retro_tv_broken_videos';

        let ytPlayer = null;
        let isPlayerReady = false;
        let isManualFS = false;
        let currentChannelIndex = 0;
        let isTvOn = false;
        let isMuted = true;
        let timer = null;
        let osdTimer = null;
        let heartbeatInterval = null;
        let lastAttemptedVideoId = null;
        let isManualSwitch = false; // Flag a szép váltáshoz

        // Element kimentése a gyors eléréshez
        const els = {
            tvSet: document.querySelector('.tv-set'),
            crtScreen: document.querySelector('.crt-screen'),
            osd: document.getElementById('osd-container'),
            osdChannel: document.getElementById('osd-channel'),
            osdTitle: document.getElementById('osd-title'),
            osdRemaining: document.getElementById('osd-remaining'),
            staticNoise: document.getElementById('static-noise'),
            channelNum: document.getElementById('channel-num'),
            powerBtn: document.getElementById('power-btn'),
            volBtn: document.getElementById('vol-btn'),
            crtBtn: document.getElementById('crt-btn'),
            scanBtn: document.getElementById('scan-btn')
        };

        // Broken videók betöltése
        const brokenVideos = new Set(JSON.parse(sessionStorage.getItem(STORAGE_KEY_BROKEN) || "[]"));

        function markVideoAsBroken(video) {
            if (!video || brokenVideos.has(video.id)) return;

            brokenVideos.add(video.id);
            sessionStorage.setItem(STORAGE_KEY_BROKEN, JSON.stringify([...brokenVideos]));
            console.warn(`Video ${video.id} marked as broken.`);
        }


        function onYouTubeIframeAPIReady() {
            const host = window.location.protocol === 'file:' ? 'http://localhost' : window.location.origin;
            ytPlayer = new YT.Player('youtube-player', {
                height: '100%',
                width: '100%',
                playerVars: {
                    'autoplay': 1,
                    'controls': 0,
                    'disablekb': 1,
                    'enablejsapi': 1,
                    'iv_load_policy': 3,
                    'modestbranding': 1,
                    'playsinline': 1,
                    'rel': 0,
                    'origin': host,
                    'vq': 'medium'
                },
                events: {
                    'onReady': () => { isPlayerReady = true; console.log("YT Ready"); },
                    'onStateChange': onPlayerStateChange,
                    'onError': handlePlayerError
                }
            });
        }

        function onPlayerStateChange(event) {
            const playerIframe = ytPlayer.getIframe();
            if (event.data == YT.PlayerState.PLAYING) {
                els.tvSet.classList.remove('changing-channel');
                els.staticNoise.style.transition = 'opacity 0.6s';
                els.staticNoise.style.opacity = '0.05';

                playerIframe.style.opacity = '1';
                // Csak akkor játszunk animációt, ha manuális váltás vagy bekapcsolás volt
                if (isManualSwitch) {
                    playerIframe.style.animation = 'turnOn 0.4s ease-out forwards';
                    isManualSwitch = false;
                } else {
                    playerIframe.style.animation = 'none';
                }
            } else if (event.data == YT.PlayerState.ENDED) {
                // Ha vége a videónak, azonnal szinkronizálunk (zökkenőmentes váltás)
                console.log("Video ended naturally, syncing next...");
                syncToBroadcast();
            }
        }

        function handlePlayerError(event) {
            console.warn("Video error detected, code: " + event.data);
            const currentChannel = CHANNELS[currentChannelIndex];
            const videoId = lastAttemptedVideoId || (ytPlayer.getVideoData ? ytPlayer.getVideoData().video_id : null);

            const videoObj = currentChannel.playlist.find(v => v.id === videoId);
            if (videoObj) {
                markVideoAsBroken(videoObj);
            }

            syncToBroadcast();
        }

        (function loadYouTubeAPI() {
            var tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            var firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        })();

        function toggleMute() {
            if (!ytPlayer || !isTvOn || !isPlayerReady) return;
            if (isMuted) {
                ytPlayer.unMute();
                isMuted = false;
                els.volBtn.classList.add('on');
            } else {
                ytPlayer.mute();
                isMuted = true;
                els.volBtn.classList.remove('on');
            }
        }

        function togglePower() {
            isTvOn ? turnOffTV() : turnOnTV();
        }

        function turnOnTV() {
            isTvOn = true;
            isManualSwitch = true; // Bekapcsoláskor legyen animáció
            els.tvSet.classList.remove('power-off');
            els.powerBtn.classList.add('on');

            // CRT bekapcsolási hang (Web Audio API)
            playPowerOnSound();

            // Automatikus hang bekapcsolás (mivel a PWR gombnyomás user interaction)
            isMuted = false;
            els.volBtn.classList.add('on');

            syncToBroadcast();

            // Heartbeat szinkron: 10 másodpercenként ellenőrizzük az elcsúszást (reklámok/pufferelés ellen)
            clearInterval(heartbeatInterval);
            heartbeatInterval = setInterval(() => {
                if (isTvOn) syncToBroadcast();
            }, 10000);
        }

        // Induláskor legyen Power Off (Sleep Mode) állapotban
        document.addEventListener('DOMContentLoaded', () => {
            els.tvSet.classList.add('power-off');
        });

        let audioCtx = null;

        function getAudioContext() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
            return audioCtx;
        }

        async function playPowerOnSound() {
            try {
                const ctx = getAudioContext();
                const now = ctx.currentTime;
                // Biztosítjuk, hogy a context fut
                if (ctx.state === 'suspended') await ctx.resume();

                // 1. Mechanikus kattanás (kapcsoló hangja)
                const clickBuffer = ctx.createBuffer(1, ctx.sampleRate * 0.05, ctx.sampleRate);
                const clickData = clickBuffer.getChannelData(0);
                for (let i = 0; i < clickData.length; i++) {
                    clickData[i] = (Math.random() * 2 - 1) * Math.exp(-i / (ctx.sampleRate * 0.008));
                }
                const clickSource = ctx.createBufferSource();
                const clickGain = ctx.createGain();
                const clickFilter = ctx.createBiquadFilter();
                clickFilter.type = 'lowpass';
                clickFilter.frequency.value = 2000;
                clickSource.buffer = clickBuffer;
                clickGain.gain.value = 0.4;
                clickSource.connect(clickFilter);
                clickFilter.connect(clickGain);
                clickGain.connect(ctx.destination);
                clickSource.start(now);

                // 2. Flyback transzformátor sivítás (15kHz - a CRT jellegzetes hangja)
                const flybackOsc = ctx.createOscillator();
                const flybackGain = ctx.createGain();
                flybackOsc.type = 'sine';
                flybackOsc.frequency.value = 15000;
                flybackGain.gain.setValueAtTime(0, now + 0.03);
                flybackGain.gain.linearRampToValueAtTime(0.015, now + 0.08);
                flybackGain.gain.exponentialRampToValueAtTime(0.001, now + 0.6);
                flybackOsc.connect(flybackGain);
                flybackGain.connect(ctx.destination);
                flybackOsc.start(now + 0.03);
                flybackOsc.stop(now + 0.6);

                // 3. Degaussing tekercs mormolás (mély rezgés)
                const degaussOsc = ctx.createOscillator();
                const degaussGain = ctx.createGain();
                degaussOsc.type = 'sine';
                degaussOsc.frequency.setValueAtTime(120, now + 0.02);
                degaussOsc.frequency.exponentialRampToValueAtTime(50, now + 0.3);
                degaussGain.gain.setValueAtTime(0, now + 0.02);
                degaussGain.gain.linearRampToValueAtTime(0.12, now + 0.05);
                degaussGain.gain.exponentialRampToValueAtTime(0.001, now + 0.35);
                degaussOsc.connect(degaussGain);
                degaussGain.connect(ctx.destination);
                degaussOsc.start(now + 0.02);
                degaussOsc.stop(now + 0.35);

                // 4. Elektromos "puff" (képcső feltöltődés)
                const puffBuffer = ctx.createBuffer(1, ctx.sampleRate * 0.15, ctx.sampleRate);
                const puffData = puffBuffer.getChannelData(0);
                for (let i = 0; i < puffData.length; i++) {
                    const t = i / ctx.sampleRate;
                    puffData[i] = (Math.random() * 2 - 1) * 0.1 * Math.exp(-t * 15);
                }
                const puffSource = ctx.createBufferSource();
                const puffGain = ctx.createGain();
                const puffFilter = ctx.createBiquadFilter();
                puffFilter.type = 'bandpass';
                puffFilter.frequency.value = 800;
                puffFilter.Q.value = 1;
                puffSource.buffer = puffBuffer;
                puffGain.gain.value = 0.5;
                puffSource.connect(puffFilter);
                puffFilter.connect(puffGain);
                puffGain.connect(ctx.destination);
                puffSource.start(now + 0.01);

            } catch (e) {
                // Ha nem támogatott, csendben folytatjuk
            }
        }

        function playSwitchSound() {
            try {
                const ctx = getAudioContext();
                const now = ctx.currentTime;

                // 1. Mechanikus "klikk"
                const clickOsc = ctx.createOscillator();
                const clickGain = ctx.createGain();
                clickOsc.type = 'square';
                clickOsc.frequency.setValueAtTime(800, now);
                clickOsc.frequency.exponentialRampToValueAtTime(100, now + 0.05);
                clickGain.gain.setValueAtTime(0.1, now);
                clickGain.gain.exponentialRampToValueAtTime(0.01, now + 0.05);
                clickOsc.connect(clickGain);
                clickGain.connect(ctx.destination);
                clickOsc.start(now);
                clickOsc.stop(now + 0.05);

                // 2. Mély "tump" (relé hang/feszültség lökés)
                const thumpOsc = ctx.createOscillator();
                const thumpGain = ctx.createGain();
                thumpOsc.type = 'sine';
                thumpOsc.frequency.setValueAtTime(60, now);
                thumpOsc.frequency.exponentialRampToValueAtTime(40, now + 0.1);
                thumpGain.gain.setValueAtTime(0.3, now);
                thumpGain.gain.exponentialRampToValueAtTime(0.01, now + 0.15);
                thumpOsc.connect(thumpGain);
                thumpGain.connect(ctx.destination);
                thumpOsc.start(now);
                thumpOsc.stop(now + 0.15);
            } catch (e) { }
        }

        function turnOffTV() {
            isTvOn = false;
            els.tvSet.classList.add('power-off'); // Sleep Mode bekapcsolása
            els.powerBtn.classList.remove('on');
            els.volBtn.classList.remove('on');
            isMuted = true;
            els.channelNum.innerText = "--";
            clearTimeout(timer);
            clearInterval(heartbeatInterval);
            if (ytPlayer && isPlayerReady) {
                ytPlayer.stopVideo();
                const playerIframe = ytPlayer.getIframe();
                playerIframe.style.opacity = '0';
                playerIframe.style.animation = 'none';
            }
            els.staticNoise.style.transition = 'none';
            els.staticNoise.style.opacity = '0';
            els.osd.classList.remove('show');
        }

        function showOSD(video, startTime) {
            if (!isTvOn) return;
            clearTimeout(osdTimer);
            const remaining = Math.max(0, video.duration - startTime);
            const mins = Math.floor(remaining / 60);
            const secs = remaining % 60;

            const currentChannel = CHANNELS[currentChannelIndex];
            els.osdChannel.innerText = `CH ${currentChannel.number}`;
            els.osdTitle.innerText = video.title;
            els.osdRemaining.innerText = `${mins}:${secs.toString().padStart(2, '0')} HÁTRA`;

            els.osd.classList.add('show');
            osdTimer = setTimeout(() => {
                els.osd.classList.remove('show');
            }, 5000);
        }

        function syncToBroadcast(isManual = false) {
            if (!isTvOn) return;
            if (isManual) isManualSwitch = true;
            const currentChannel = CHANNELS[currentChannelIndex];

            // 1. Csak a működő videókat vesszük figyelembe (Dinamikus Virtuális Csatorna)
            const workingPlaylist = currentChannel.playlist.filter(vid => !brokenVideos.has(vid.id));

            if (workingPlaylist.length === 0) {
                console.error("No working videos left on this channel!");
                els.channelNum.innerText = "ERR";
                return;
            }

            // 2. Determinisztikus Matematika: Az eltel időt a működő tartalom összhosszára vetítjük
            // Ez garantálja, hogy minden eszköz ugyanott tartson, és nincs ismétlés/loop hiba.
            const totalWorkingDuration = workingPlaylist.reduce((sum, vid) => sum + vid.duration, 0);
            const elapsed = Math.floor(Date.now() / 1000) - REFERENCE_TIME;

            // Modulo eltolás kiszámítása
            let cycleTime = ((elapsed % totalWorkingDuration) + totalWorkingDuration) % totalWorkingDuration;

            let accumulated = 0;
            for (let i = 0; i < workingPlaylist.length; i++) {
                const vid = workingPlaylist[i];
                if (cycleTime >= accumulated && cycleTime < accumulated + vid.duration) {
                    els.channelNum.innerText = currentChannel.number;
                    playChannel(vid, Math.floor(cycleTime - accumulated), isManual);
                    return;
                }
                accumulated += vid.duration;
            }
        }

        function playChannel(video, startTime = 0, isManual = false) {
            if (!isPlayerReady) {
                setTimeout(() => playChannel(video, startTime, isManual), 300);
                return;
            }

            // Akadozás elleni védelem: Ha már ez megy és jó helyen tart, ne töltsük újra
            if (ytPlayer.getPlayerState() === YT.PlayerState.PLAYING || ytPlayer.getPlayerState() === YT.PlayerState.BUFFERING) {
                const currentData = ytPlayer.getVideoData();
                const currentTime = ytPlayer.getCurrentTime();

                if (currentData && currentData.video_id === video.id) {
                    const drift = Math.abs(currentTime - startTime);

                    if (drift < 3) {
                        clearTimeout(timer);
                        timer = setTimeout(() => syncToBroadcast(false), (video.duration - currentTime + 1) * 1000);
                        return;
                    } else if (drift < 30) {
                        console.log(`Soft-sync active: drifting ${Math.floor(drift)}s. Seeking...`);
                        ytPlayer.seekTo(startTime, true);
                        clearTimeout(timer);
                        timer = setTimeout(() => syncToBroadcast(false), (video.duration - startTime + 1) * 1000);
                        return;
                    }
                }
            }

            if (isManual) {
                els.tvSet.classList.add('changing-channel');
                els.staticNoise.style.opacity = '1';
                playSwitchSound();

                const playerIframe = ytPlayer.getIframe();
                if (playerIframe) {
                    playerIframe.classList.remove('vsync-jump', 'blackout');
                    void playerIframe.offsetWidth; // Reflow kényszerítése gyanánt
                    playerIframe.classList.add('vsync-jump', 'blackout');
                }
            } else {
                // Smooth transition: csak elhalványítás és halkítás nélkül indítjuk
                const playerIframe = ytPlayer.getIframe();
                if (playerIframe) {
                    playerIframe.classList.remove('vsync-jump', 'blackout');
                    playerIframe.style.transition = 'opacity 0.2s';
                    playerIframe.style.opacity = '0';
                }
            }

            clearTimeout(timer);
            const delay = isManual ? 400 : 100; // Manuális váltásnál van idő a zajra

            setTimeout(() => {
                if (!isTvOn) return;
                lastAttemptedVideoId = video.id;
                ytPlayer.loadVideoById({ videoId: video.id, startSeconds: startTime, suggestedQuality: 'medium' });
                isMuted ? ytPlayer.mute() : ytPlayer.unMute();

                showOSD(video, startTime);

                // Időzítés a videó vége után 1 másodperccel
                timer = setTimeout(() => syncToBroadcast(false), (video.duration - startTime + 1) * 1000);
            }, delay);
        }

        function nextChannel() {
            if (isTvOn) {
                clearTimeout(timer);
                currentChannelIndex = (currentChannelIndex + 1) % CHANNELS.length;
                syncToBroadcast(true); // Manuális váltás
            }
        }
        function prevChannel() {
            if (isTvOn) {
                clearTimeout(timer);
                currentChannelIndex = (currentChannelIndex - 1 + CHANNELS.length) % CHANNELS.length;
                syncToBroadcast(true); // Manuális váltás
            }
        }

        function toggleFullscreen() {
            const tvSet = document.querySelector('.tv-set');

            // Megnézzük a natív állapotot
            const isNativeFS = !!(document.fullscreenElement || document.webkitFullscreenElement ||
                document.mozFullScreenElement || document.msFullscreenElement);

            if (isNativeFS || isManualFS) {
                // Kilépés
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }

                if (isManualFS) {
                    isManualFS = false;
                    handleFullscreenChange(false);
                }
            } else {
                // Belépés próbája
                let requestPromise = null;
                if (tvSet.requestFullscreen) {
                    requestPromise = tvSet.requestFullscreen();
                } else if (tvSet.webkitRequestFullscreen) {
                    requestPromise = tvSet.webkitRequestFullscreen();
                } else if (tvSet.mozRequestFullScreen) {
                    requestPromise = tvSet.mozRequestFullScreen();
                } else if (tvSet.msRequestFullscreen) {
                    requestPromise = tvSet.msRequestFullscreen();
                }

                if (requestPromise) {
                    requestPromise.catch(() => {
                        // Ha a böngésző elutasítja a natívat (pl. nem biztonságos környezet)
                        isManualFS = true;
                        handleFullscreenChange(true);
                    });
                } else {
                    // Ha nincs natív támogatás (pl. iPhone Safari)
                    isManualFS = true;
                    handleFullscreenChange(true);
                }
            }
        }

        function toggleCRT() {
            els.crtScreen.classList.toggle('crt-off');
            els.crtBtn.classList.toggle('on');
        }

        function toggleZoom() {
            const isActive = els.tvSet.classList.toggle('zoom-active');
            els.scanBtn.classList.toggle('on', isActive);

            const fullLabel = els.scanBtn.querySelector('.full-label');
            const shortLabel = els.scanBtn.querySelector('.short-label');

            if (isActive) {
                fullLabel.innerHTML = '<br>KÉPARÁNY<br>SCAN';
                shortLabel.innerText = 'SCAN';
            } else {
                fullLabel.innerHTML = '<br>KÉPARÁNY<br>4:3';
                shortLabel.innerText = '4:3';
            }
        }

        function handleFullscreenChange(isFS) {
            if (isFS) {
                els.tvSet.classList.add('manual-fullscreen');
                Object.assign(els.tvSet.style, { width: '100vw', height: '100vh', maxWidth: 'none', maxHeight: 'none', borderRadius: '0', padding: '0' });
                els.tvSet.classList.add('tv-fullscreen-mode', 'show-controls'); // Azonnal mutassuk

                // 2,5 másodperc után elrejtjük, ha nincs interakció
                clearTimeout(window.controlsTimer);
                window.controlsTimer = setTimeout(() => {
                    tvSet.classList.remove('show-controls');
                }, 2500);
            } else {
                els.tvSet.classList.remove('manual-fullscreen');
                els.tvSet.classList.remove('show-controls');
                Object.assign(els.tvSet.style, { width: '', height: '', maxWidth: '', maxHeight: '', borderRadius: '', padding: '' });
                els.tvSet.classList.remove('tv-fullscreen-mode');
            }
        }

        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement) {
                isManualFS = false;
                handleFullscreenChange(false);
            } else {
                handleFullscreenChange(true);
            }
        });

        document.addEventListener('webkitfullscreenchange', () => {
            if (!document.webkitFullscreenElement) {
                isManualFS = false;
                handleFullscreenChange(false);
            } else {
                handleFullscreenChange(true);
            }
        });

        // Új megoldás: Kattintás a képernyőre toggolja a gombokat teljes képernyőben
        document.querySelector('.glass-overlay').addEventListener('click', (e) => {
            if (els.tvSet.classList.contains('tv-fullscreen-mode')) {
                els.tvSet.classList.toggle('show-controls');

                // Automatikus elrejtés 2,5 másodperc után, ha nem nyúlnak hozzá
                clearTimeout(window.controlsTimer);
                if (els.tvSet.classList.contains('show-controls')) {
                    window.controlsTimer = setTimeout(() => {
                        els.tvSet.classList.remove('show-controls');
                    }, 2500);
                }
            }
        });
        // Android TV detektálás és optimalizálás
        function detectTV() {
            const ua = navigator.userAgent.toLowerCase();
            const isTV = ua.includes('tv') ||
                (ua.includes('android') && !ua.includes('mobile')) ||
                ua.includes('smart-tv') ||
                ua.includes('google-tv') ||
                ua.includes('bravia') ||
                ua.includes('web0s') ||
                ua.includes('tizen');

            if (isTV) {
                document.body.classList.add('tv-mode');
                console.log("TV Mode Activated: Optimized for performance");
            }
        }

        // Futás azonnal
        detectTV();
    </script>
</body>

</html>


